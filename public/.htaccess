<IfModule mod_headers.c>
  Header set X-DNS-Prefetch-Control "on"
  Header set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-Content-Type-Options "nosniff"
  Header set Referrer-Policy "origin-when-cross-origin"
  Header set Permissions-Policy "camera=(), microphone=(), geolocation=(), interest-cohort=()"
  Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https://www.google-analytics.com https://www.googletagmanager.com; font-src 'self' data:; connect-src 'self' https://www.google-analytics.com https://analytics.google.com https://www.googletagmanager.com; frame-ancestors 'self'"
</IfModule>

RewriteEngine On
RewriteBase /

# Serve existing files directly
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Serve existing directories with index.html
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# If a trailing-slash index.html exists for this path, serve it
RewriteCond %{DOCUMENT_ROOT}/$1/index.html -f
RewriteRule ^(.+?)/?$ /$1/index.html [L]

# Everything else: serve the custom 404 page
RewriteRule ^ /404/index.html [L]

# ErrorDocument using absolute URL forces LiteSpeed to use our page
ErrorDocument 404 /404.html
